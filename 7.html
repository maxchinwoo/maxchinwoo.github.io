<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì•”ê¸°ë ¥ ê²Œì„</title>
  <style>
    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      font-family: Arial, sans-serif;
      background: #101725;
      color: #e8f1ff;
    }
    #modeButtons {
      margin-bottom: 20px;
      display: flex;
      gap: 20px;
    }
    #modeButtons button {
      padding: 16px 32px; /* ë²„íŠ¼ í¬ê¸° 2ë°° */
      font-size: 1.8em;   /* ê¸€ì í¬ê¸° 2ë°° */
      border: none;
      border-radius: 8px;
      background: #007bff;
      color: white;
      cursor: pointer;
    }
    #modeButtons button.active {
      background: #28a745;
    }
    #game {
      display: grid;
      justify-content: center;
      align-content: center;
      gap: 8px;
      width: 90vmin;
      height: 90vmin;
      margin-top: 20px;
    }
    .cell {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f0f0f0;
      font-size: 8vmin; /* ìˆ«ì/í•œê¸€ í¬ê¸° 2ë°° */
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      user-select: none;
      touch-action: manipulation;
      color: #000;
      transform: scale(1.0); /* ì›ë˜ 0.7 â†’ í™•ëŒ€ */
    }
    .cell:active {
      background: #ddd;
    }
    #status {
      font-size: 2.6em; /* ìƒíƒœ ë©”ì‹œì§€ í¬ê¸° í™•ëŒ€ */
      margin-top: 16px;
    }
    #buttons {
      margin-top: 25px;
      display: flex;
      gap: 16px;
    }
    button {
      padding: 16px 32px; /* ë²„íŠ¼ í¬ê¸° 2ë°° */
      font-size: 1.8em;   /* ê¸€ì í¬ê¸° 2ë°° */
      border: none;
      border-radius: 8px;
      background: #007bff;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <h1>ì•”ê¸°ë ¥ ê²Œì„</h1>
  
  <div id="modeButtons">
    <button id="numberMode">ğŸ”¢ ìˆ«ì</button>
    <button id="koreanMode">ã„± í•œê¸€</button>
  </div>

  <div id="status">ê²Œì„ ëª¨ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”!</div>
  <div id="game"></div>
  <div id="buttons">
    <button id="startBtn">â–¶ ì‹œì‘</button>
    <button id="resetBtn">ğŸ”„ ë¦¬ì…‹</button>
    <button id="homeBtn">ğŸ  í™ˆ</button>
  </div>

  <script>
    const gameContainer = document.getElementById("game");
    const statusDiv = document.getElementById("status");
    const startBtn = document.getElementById("startBtn");
    const resetBtn = document.getElementById("resetBtn");
    const homeBtn = document.getElementById("homeBtn");

    const numberModeBtn = document.getElementById("numberMode");
    const koreanModeBtn = document.getElementById("koreanMode");

    let currentLevel = 1;
    let sequence = [];
    let userIndex = 0;
    let isRevealing = false;
    let currentMode = "number";

    const koreanLetters = ["ê°€","ë‚˜","ë‹¤","ë¼","ë§ˆ","ë°”","ì‚¬","ì•„","ì","ì°¨","ì¹´","íƒ€","íŒŒ","í•˜","ê±°","ë„ˆ"];

    const levelSettings = {
      1: { rows: 2, cols: 2, count: 4 },
      2: { rows: 2, cols: 3, count: 6 },
      3: { rows: 3, cols: 3, count: 9 },
      4: { rows: 3, cols: 4, count: 12 },
      5: { rows: 4, cols: 4, count: 16 },
    };

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function prepareLevel(level) {
      gameContainer.innerHTML = "";
      userIndex = 0;
      const { rows, cols, count } = levelSettings[level];
      gameContainer.style.gridTemplateRows = `repeat(${rows}, 1fr)`;
      gameContainer.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

      for (let i = 0; i < count; i++) {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.textContent = "!";
        gameContainer.appendChild(cell);
      }
      statusDiv.textContent = `${level}ë‹¨ê³„: ì‹œì‘ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”`;
    }

    function startLevel(level) {
      gameContainer.innerHTML = "";
      userIndex = 0;
      const { rows, cols, count } = levelSettings[level];
      const time = count * 1000;

      if (currentMode === "number") {
        sequence = shuffle([...Array(count).keys()].map(n => n + 1));
      } else if (currentMode === "korean") {
        sequence = shuffle(koreanLetters.slice(0, count)); // ëœë¤ ë°°ì¹˜
      }

      gameContainer.style.gridTemplateRows = `repeat(${rows}, 1fr)`;
      gameContainer.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

      sequence.forEach((item, idx) => {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.textContent = item;
        cell.onclick = () => handleClick(item, idx, cell);
        gameContainer.appendChild(cell);
      });

      statusDiv.textContent = `${level}ë‹¨ê³„: ì™¸ìš°ì„¸ìš”! (${count}ê°œ, ${time/1000}ì´ˆ)`;
      isRevealing = true;

      setTimeout(() => {
        document.querySelectorAll(".cell").forEach(cell => {
          cell.textContent = "?";
        });
        statusDiv.textContent = `${level}ë‹¨ê³„: ìˆœì„œëŒ€ë¡œ í´ë¦­í•˜ì„¸ìš”!`;
        isRevealing = false;
      }, time);
    }

    function handleClick(item, idx, cell) {
      if (isRevealing) return;

      if (currentMode === "number") {
        if (item === userIndex + 1) {
          cell.textContent = item;
          cell.style.background = "#90ee90";
          userIndex++;
        } else {
          fail();
          return;
        }
      } else if (currentMode === "korean") {
        if (item === koreanLetters[userIndex]) {
          cell.textContent = item;
          cell.style.background = "#90ee90";
          userIndex++;
        } else {
          fail();
          return;
        }
      }

      if (userIndex === (currentMode === "number" ? sequence.length : koreanLetters.slice(0, levelSettings[currentLevel].count).length)) {
        if (currentLevel === 5) {
          statusDiv.textContent = "ğŸ‰ ê²Œì„ ì„±ê³µ!";
        } else {
          statusDiv.textContent = `âœ… ${currentLevel}ë‹¨ê³„ í†µê³¼!`;
          currentLevel++;
          setTimeout(() => prepareLevel(currentLevel), 2000);
        }
      }
    }

    function fail() {
      statusDiv.textContent = "âŒ í‹€ë ¸ìŠµë‹ˆë‹¤! ë‹¤ì‹œ ë„ì „í•˜ì„¸ìš”.";
      setTimeout(() => prepareLevel(currentLevel), 2000);
    }

    function setActiveButton(activeBtn) {
      [numberModeBtn, koreanModeBtn].forEach(btn => btn.classList.remove("active"));
      activeBtn.classList.add("active");
    }

    numberModeBtn.onclick = () => { currentMode = "number"; currentLevel = 1; prepareLevel(currentLevel); setActiveButton(numberModeBtn); };
    koreanModeBtn.onclick = () => { currentMode = "korean"; currentLevel = 1; prepareLevel(currentLevel); setActiveButton(koreanModeBtn); };

    startBtn.onclick = () => { startLevel(currentLevel); };
    resetBtn.onclick = () => { currentLevel = 1; prepareLevel(currentLevel); };
    homeBtn.onclick = () => { location.href = "index.html"; };

    statusDiv.textContent = "ê²Œì„ ëª¨ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”!";
  </script>
</body>
</html>
